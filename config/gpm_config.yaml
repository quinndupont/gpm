project_name: "Good Poetry Model"
version: "2.0.0"

hardware:
  total_ram_gb: 24
  reserved_ram_gb: 4
  available_ram_gb: 20
  metal_enabled: true

ollama:
  model: "llama3.2:3b"
  host: "http://localhost:11434"
  temperature: 0.9
  max_tokens: 800
  rate_limit_delay: 0.5

datasets:
  - name: "gutenberg"
    repo: "matthh/gutenberg-poetry-corpus"
    weight: 1.0
  - name: "merve"
    repo: "merve/poetry"
    weight: 1.0
  - name: "public_domain"
    repo: "DanFosing/public-domain-poetry"
    weight: 0.8
  - name: "modern"
    repo: "jassiyu/poetry-modern"
    weight: 1.0

processing:
  min_poem_length: 150
  max_poem_length: 8000
  min_lines: 4
  deduplication: true
  quality_filter: true
  use_offline: true
  use_local_processed: true
  dedup:
    split_method: word_ngram
    ngram_size: 13
    similarity_threshold: 0.8
    num_minhashes: 128

data_preparation:
  reverse_prompt_limit: 1000
  synthetic_count: 2000
  quinn_poems_file: "data/processed/quinn_poems.jsonl"
  quinn_repeat: 5
  style_topics:
    # Quinn's themes
    - embodiment and physical joy
    - community wealth vs accumulation
    - AI consciousness and writing
    - winter light and seasonal change
    - authority and self-sufficiency
    - children discovering the world
    - the nature of writing itself
    - anarchist domesticity
    # Broader poetic territory
    - grief and remembrance
    - love between strangers
    - the sea at night
    - aging and the body
    - solitude in a city
    - animals observed closely
    - a meal shared with friends
    - the passage of seasons

validation:
  min_poem_length: 50
  min_lines: 2
  check_repetition: true
  dedup:
    split_method: word_ngram
    ngram_size: 13
    similarity_threshold: 0.8

training:
  task: poetry_generation
  base_model: "mlx-community/Llama-3.2-3B-Instruct-4bit"
  lora_rank: 32
  lora_alpha: 64
  num_layers: 20
  dropout: 0.0
  batch_size: 1
  iterations: 3000
  learning_rate: 0.00002
  steps_per_eval: 50
  save_every: 100
  max_seq_length: 2048
  gradient_checkpointing: true
  eval_prompts:
    - "Write a poem about AI as a new form of writing, not a new form of life"
    - "Write a children's poem about a dog who discovers something unexpected in the garden"
    - "Write a poem questioning why we measure wealth by what we own rather than who we know"
    - "Write a poem about winter morning light arriving uninvited"
